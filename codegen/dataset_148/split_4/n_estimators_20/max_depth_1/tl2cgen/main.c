
#include "header.h"


static const int32_t num_class[] = {  7, };

int32_t get_num_target(void) {
  return N_TARGET;
}
void get_num_class(int32_t* out) {
  for (int i = 0; i < N_TARGET; ++i) {
    out[i] = num_class[i];
  }
}
int32_t get_num_feature(void) {
  return 7;
}
const char* get_threshold_type(void) {
  return "float32";
}
const char* get_leaf_output_type(void) {
  return "float32";
}


void predict(union Entry* data, int pred_margin, float* result) {
  unsigned int tmp;
  if ( ( !(data[2].missing != -1) || (data[2].fvalue <= (float)4) ) ) {
    result[0] += 0.2136898395721925;
    result[1] += 0.0027807486631016044;
    result[2] += 0.005561497326203209;
    result[3] += 0.41518716577540105;
    result[4] += 0.3627807486631016;
    result[5] += 0;
    result[6] += 0;
  } else {
    result[0] += 0.8556084996780425;
    result[1] += 0.000489375402446877;
    result[2] += 0.002189311010946555;
    result[3] += 0.12038634900193175;
    result[4] += 0.020837089504185446;
    result[5] += 0.000128783000643915;
    result[6] += 0.000360592401802962;
  }
  if ( ( !(data[3].missing != -1) || (data[3].fvalue <= (float)-0.5) ) ) {
    result[0] += 0.7645002056766763;
    result[1] += 0.0003427944604415193;
    result[2] += 0.003427944604415193;
    result[3] += 0.18641162758809818;
    result[4] += 0.044083367612779374;
    result[5] += 0.0005484711367064308;
    result[6] += 0.0006855889208830385;
  } else {
    result[0] += 0.799681815037698;
    result[1] += 0.0012104862696271702;
    result[2] += 0.0026976551151691223;
    result[3] += 0.13484817043646677;
    result[4] += 0.061077678633188075;
    result[5] += 0.0001729266099467386;
    result[6] += 0.00031126789790412947;
  }
  if ( ( !(data[6].missing != -1) || (data[6].fvalue <= (float)3) ) ) {
    result[0] += 0.9991606577391172;
    result[1] += 0;
    result[2] += 0.0006867345770859563;
    result[3] += 0;
    result[4] += 0.00011445576284765938;
    result[5] += 0;
    result[6] += 3.815192094921979e-05;
  } else {
    result[0] += 0.4638787668459714;
    result[1] += 0.0019665683382497543;
    result[2] += 0.006535947712418301;
    result[3] += 0.3847533113540401;
    result[4] += 0.14124587888252646;
    result[5] += 0.0008676036786395974;
    result[6] += 0.0007519231881543178;
  }
  if ( ( !(data[2].missing != -1) || (data[2].fvalue <= (float)4) ) ) {
    result[0] += 0.19873748367435787;
    result[1] += 0.0032651284283848497;
    result[2] += 0.00478885502829778;
    result[3] += 0.43905093600348283;
    result[4] += 0.3541575968654767;
    result[5] += 0;
    result[6] += 0;
  } else {
    result[0] += 0.85770832262376;
    result[1] += 0.00030843571685601197;
    result[2] += 0.002981545262941449;
    result[3] += 0.11679432478280986;
    result[4] += 0.021590500179920837;
    result[5] += 0.00025702976404667666;
    result[6] += 0.0003598416696653473;
  }
  if ( ( !(data[4].missing != -1) || (data[4].fvalue <= (float)25.5) ) ) {
    result[0] += 0.11473109898674981;
    result[1] += 0.002338269680436477;
    result[2] += 0.0034294621979734994;
    result[3] += 0.49649259547934527;
    result[4] += 0.3819173811379579;
    result[5] += 0.0010911925175370225;
    result[6] += 0;
  } else {
    result[0] += 0.903438047728192;
    result[1] += 0.0008359174868545234;
    result[2] += 0.002696508022111366;
    result[3] += 0.09267898071996764;
    result[4] += 0;
    result[5] += 0;
    result[6] += 0.00035054604287447754;
  }
  if ( ( !(data[2].missing != -1) || (data[2].fvalue <= (float)4) ) ) {
    result[0] += 0.20518502105029915;
    result[1] += 0.005761134500332373;
    result[2] += 0.006869044981165522;
    result[3] += 0.43031243075559494;
    result[4] += 0.351872368712608;
    result[5] += 0;
    result[6] += 0;
  } else {
    result[0] += 0.8542078128606972;
    result[1] += 0.00030779490599430585;
    result[2] += 0.002564957549952549;
    result[3] += 0.12060430399876883;
    result[4] += 0.021750840023597614;
    result[5] += 0.0002051966039962039;
    result[6] += 0.0003590940569933568;
  }
  if ( ( !(data[4].missing != -1) || (data[4].fvalue <= (float)25.5) ) ) {
    result[0] += 0.11808927173061863;
    result[1] += 0.0020360219263899767;
    result[2] += 0.003915426781519186;
    result[3] += 0.48817541111981205;
    result[4] += 0.38668754894283475;
    result[5] += 0.001096319498825372;
    result[6] += 0;
  } else {
    result[0] += 0.9042166240064664;
    result[1] += 0.0007005253940455342;
    result[2] += 0.0026404418698639364;
    result[3] += 0.092065202748215;
    result[4] += 0;
    result[5] += 5.38865687727334e-05;
    result[6] += 0.0003233194126364004;
  }
  if ( ( !(data[2].missing != -1) || (data[2].fvalue <= (float)4) ) ) {
    result[0] += 0.19716190066652334;
    result[1] += 0.003010105353687379;
    result[2] += 0.00666523328316491;
    result[3] += 0.43797032896151367;
    result[4] += 0.3551924317351107;
    result[5] += 0;
    result[6] += 0;
  } else {
    result[0] += 0.8569589950835284;
    result[1] += 0.0003861103245900794;
    result[2] += 0.0021879585060104504;
    result[3] += 0.11874179515560243;
    result[4] += 0.02108162372261834;
    result[5] += 0.00020592550644804236;
    result[6] += 0.00043759170120209;
  }
  if ( ( !(data[6].missing != -1) || (data[6].fvalue <= (float)3) ) ) {
    result[0] += 0.9993565480696442;
    result[1] += 0;
    result[2] += 0.00034065102195306586;
    result[3] += 0;
    result[4] += 7.57002271006813e-05;
    result[5] += 0;
    result[6] += 0.0002271006813020439;
  } else {
    result[0] += 0.46750585480093687;
    result[1] += 0.0022248243559718976;
    result[2] += 0.006674473067915692;
    result[3] += 0.3847775175644029;
    result[4] += 0.1377634660421546;
    result[5] += 0.0005854800936768151;
    result[6] += 0.0004683840749414521;
  }
  if ( ( !(data[6].missing != -1) || (data[6].fvalue <= (float)3) ) ) {
    result[0] += 0.9993153811045185;
    result[1] += 0;
    result[2] += 0.00045641259698767686;
    result[3] += 0;
    result[4] += 0.00015213753232922562;
    result[5] += 0;
    result[6] += 7.606876616461281e-05;
  } else {
    result[0] += 0.4656555090655509;
    result[1] += 0.0018596001859600185;
    result[2] += 0.006101813110181311;
    result[3] += 0.38034635053463506;
    result[4] += 0.1449907019990702;
    result[5] += 0.0003486750348675035;
    result[6] += 0.000697350069735007;
  }
  if ( ( !(data[4].missing != -1) || (data[4].fvalue <= (float)25.5) ) ) {
    result[0] += 0.11847389558232933;
    result[1] += 0.0016991041087426632;
    result[2] += 0.0037071362372567197;
    result[3] += 0.5018535681186285;
    result[4] += 0.3731850478838431;
    result[5] += 0.0010812480691998767;
    result[6] += 0;
  } else {
    result[0] += 0.9039863879436072;
    result[1] += 0.0005131529195700319;
    result[2] += 0.002484740452654891;
    result[3] += 0.09263760600658996;
    result[4] += 0;
    result[5] += 5.401609679684546e-05;
    result[6] += 0.00032409658078107277;
  }
  if ( ( !(data[5].missing != -1) || (data[5].fvalue <= (float)87.5) ) ) {
    result[0] += 0.8382407476080991;
    result[1] += 0.0004944498009839552;
    result[2] += 0.0021508566342802048;
    result[3] += 0.1356275804098989;
    result[4] += 0.0231402506860491;
    result[5] += 0.00014833494029518654;
    result[6] += 0.00019777992039358205;
  } else {
    result[0] += 0.08849557522123894;
    result[1] += 0.006227466404457555;
    result[2] += 0.0032776138970829235;
    result[3] += 0.4051130776794494;
    result[4] += 0.4968862667977712;
    result[5] += 0;
    result[6] += 0;
  }
  if ( ( !(data[4].missing != -1) || (data[4].fvalue <= (float)23.5) ) ) {
    result[0] += 0.03718535469107551;
    result[1] += 0.0015255530129672007;
    result[2] += 0.0043859649122807015;
    result[3] += 0.4958047292143402;
    result[4] += 0.4597635392829901;
    result[5] += 0.0013348588863463006;
    result[6] += 0;
  } else {
    result[0] += 0.8901087411125053;
    result[1] += 0.0006796319531576746;
    result[2] += 0.002561689669594312;
    result[3] += 0.10625784190715182;
    result[4] += 0;
    result[5] += 0.00013069845253032205;
    result[6] += 0.0002613969050606441;
  }
  if ( ( !(data[4].missing != -1) || (data[4].fvalue <= (float)25.5) ) ) {
    result[0] += 0.11680517082179132;
    result[1] += 0.0013850415512465374;
    result[2] += 0.0035395506309633734;
    result[3] += 0.4930747922437673;
    result[4] += 0.3838104032009849;
    result[5] += 0.0013850415512465374;
    result[6] += 0;
  } else {
    result[0] += 0.9002756607750932;
    result[1] += 0.0009458948164964056;
    result[2] += 0.002621479920004324;
    result[3] += 0.0958596832603643;
    result[4] += 0;
    result[5] += 2.7025566185611588e-05;
    result[6] += 0.0002702556618561159;
  }
  if ( ( !(data[6].missing != -1) || (data[6].fvalue <= (float)3) ) ) {
    result[0] += 0.9990866537275944;
    result[1] += 0;
    result[2] += 0.0005708414202534536;
    result[3] += 0;
    result[4] += 0.00019028047341781786;
    result[5] += 0;
    result[6] += 0.00015222437873425428;
  } else {
    result[0] += 0.46681762759101203;
    result[1] += 0.0025547233350751903;
    result[2] += 0.0064448702316669566;
    result[3] += 0.38471810950473206;
    result[4] += 0.138767926609766;
    result[5] += 0.00034837136387388956;
    result[6] += 0.00034837136387388956;
  }
  if ( ( !(data[4].missing != -1) || (data[4].fvalue <= (float)25.5) ) ) {
    result[0] += 0.11778507742843737;
    result[1] += 0.001720631941185672;
    result[2] += 0.004223369310183013;
    result[3] += 0.5058657907085876;
    result[4] += 0.3696230251837948;
    result[5] += 0.0007821054278116691;
    result[6] += 0;
  } else {
    result[0] += 0.903252755544776;
    result[1] += 0.0005120327700972863;
    result[2] += 0.0029105020616056274;
    result[3] += 0.09294742231923897;
    result[4] += 0;
    result[5] += 2.694909316301507e-05;
    result[6] += 0.0003503382111191959;
  }
  if ( ( !(data[6].missing != -1) || (data[6].fvalue <= (float)31) ) ) {
    result[0] += 0.9054257620990934;
    result[1] += 0.00041083509079455505;
    result[2] += 0.0020541754539727753;
    result[3] += 0.08931554873873628;
    result[4] += 0.0025745665689792118;
    result[5] += 0;
    result[6] += 0.0002191120484237627;
  } else {
    result[0] += 0.17155530118758047;
    result[1] += 0.002003147803691515;
    result[2] += 0.008728001144655887;
    result[3] += 0.4800400629560738;
    result[4] += 0.33652883102017456;
    result[5] += 0.001144655887823723;
    result[6] += 0;
  }
  if ( ( !(data[6].missing != -1) || (data[6].fvalue <= (float)3) ) ) {
    result[0] += 0.999164451196354;
    result[1] += 0;
    result[2] += 0.0006076718571971136;
    result[3] += 0;
    result[4] += 0.00018989745537409798;
    result[5] += 0;
    result[6] += 3.79794910748196e-05;
  } else {
    result[0] += 0.4659871869539895;
    result[1] += 0.0019801980198019802;
    result[2] += 0.006290040768782761;
    result[3] += 0.3815958066394875;
    result[4] += 0.142748980780431;
    result[5] += 0.0006988934187536401;
    result[6] += 0.0006988934187536401;
  }
  if ( ( !(data[6].missing != -1) || (data[6].fvalue <= (float)3) ) ) {
    result[0] += 0.9994253534076544;
    result[1] += 0;
    result[2] += 0.00038309772823047163;
    result[3] += 0;
    result[4] += 0.00011492931846914149;
    result[5] += 0;
    result[6] += 7.661954564609433e-05;
  } else {
    result[0] += 0.47054089785595216;
    result[1] += 0.002529171696269472;
    result[2] += 0.005575673966775881;
    result[3] += 0.3840317296085532;
    result[4] += 0.13605794102431454;
    result[5] += 0.000632292924067368;
    result[6] += 0.000632292924067368;
  }
  if ( ( !(data[5].missing != -1) || (data[5].fvalue <= (float)87.5) ) ) {
    result[0] += 0.8392888053611613;
    result[1] += 0.0003956576572120973;
    result[2] += 0.0030416182398179978;
    result[3] += 0.13358391651623436;
    result[4] += 0.023294344568362227;
    result[5] += 0.00017310022503029256;
    result[6] += 0.0002225574321818047;
  } else {
    result[0] += 0.08657301535445933;
    result[1] += 0.004573668735707285;
    result[2] += 0.001633453119895459;
    result[3] += 0.4148970924534466;
    result[4] += 0.49232277033649136;
    result[5] += 0;
    result[6] += 0;
  }
  
  // Average tree outputs
  result[0] /= 20;
  result[1] /= 20;
  result[2] /= 20;
  result[3] /= 20;
  result[4] /= 20;
  result[5] /= 20;
  result[6] /= 20;
  
  // Apply base_scores
  result[0] += 0;
  result[1] += 0;
  result[2] += 0;
  result[3] += 0;
  result[4] += 0;
  result[5] += 0;
  result[6] += 0;
  
  // Apply postprocessor
  if (!pred_margin) { postprocess(result); }
}

void postprocess(float* result) {
  // Do nothing
}


int main() {
    float result[MAX_N_CLASS];
    union Entry input[TEST_DATA_COLS];
    char line[1024];
    

    FILE* file = fopen("./codegen/dataset_148/split_4/test_data.csv", "r");
    if (file == NULL) {
        printf("Error opening file\n");
        return 1;
    }

    while (fgets(line, sizeof(line), file)) {
        char *ptr = line;
        for (int i = 0; i < TEST_DATA_COLS; i++) {
            sscanf(ptr, "%f", &(input[i].fvalue));
            input[i].missing = -1;
            while (*ptr != ',' && *ptr != '\n' && *ptr != '\0') ptr++;  // Skip to next comma
            if (*ptr == ',') ptr++;  // Move past the comma
        }
        predict(input, 0, result);
        
    }
    

    return 0;
}
