
#include "header.h"


static const int32_t num_class[] = {  6, };

int32_t get_num_target(void) {
  return N_TARGET;
}
void get_num_class(int32_t* out) {
  for (int i = 0; i < N_TARGET; ++i) {
    out[i] = num_class[i];
  }
}
int32_t get_num_feature(void) {
  return 36;
}
const char* get_threshold_type(void) {
  return "float32";
}
const char* get_leaf_output_type(void) {
  return "float32";
}


void predict(union Entry* data, int pred_margin, float* result) {
  unsigned int tmp;
  if ( ( !(data[12].missing != -1) || (data[12].fvalue <= (float)79.5) ) ) {
    result[0] += 0.3103734439834025;
    result[1] += 0.1405255878284924;
    result[2] += 0.022959889349930845;
    result[3] += 0.08243430152143845;
    result[4] += 0.13914246196403873;
    result[5] += 0.30456431535269707;
  } else {
    result[0] += 0.01486374896779521;
    result[1] += 0.011560693641618497;
    result[2] += 0.7803468208092486;
    result[3] += 0.12303881090008258;
    result[4] += 0.010734929810074319;
    result[5] += 0.05945499587118084;
  }
  if ( ( !(data[12].missing != -1) || (data[12].fvalue <= (float)81) ) ) {
    result[0] += 0.31001335113484646;
    result[1] += 0.14419225634178906;
    result[2] += 0.030707610146862484;
    result[3] += 0.08945260347129506;
    result[4] += 0.14125500667556742;
    result[5] += 0.28437917222963954;
  } else {
    result[0] += 0.012950971322849213;
    result[1] += 0.0064754856614246065;
    result[2] += 0.81313598519889;
    result[3] += 0.12210915818686402;
    result[4] += 0.0037002775208140612;
    result[5] += 0.041628122109158186;
  }
  if ( ( !(data[8].missing != -1) || (data[8].fvalue <= (float)81) ) ) {
    result[0] += 0.30193172797036255;
    result[1] += 0.1383964011643292;
    result[2] += 0.037046837787774546;
    result[3] += 0.1061127282349828;
    result[4] += 0.13495633765546441;
    result[5] += 0.28155596718708653;
  } else {
    result[0] += 0.012416427889207259;
    result[1] += 0.012416427889207259;
    result[2] += 0.7936962750716332;
    result[3] += 0.10601719197707736;
    result[4] += 0.0019102196752626551;
    result[5] += 0.07354345749761222;
  }
  if ( ( !(data[20].missing != -1) || (data[20].fvalue <= (float)78.5) ) ) {
    result[0] += 0.3229453943739658;
    result[1] += 0.14754550468836183;
    result[2] += 0.014892443463872035;
    result[3] += 0.08742415885273028;
    result[4] += 0.138996138996139;
    result[5] += 0.28819635962493106;
  } else {
    result[0] += 0.011666666666666667;
    result[1] += 0.008333333333333333;
    result[2] += 0.7391666666666666;
    result[3] += 0.15333333333333332;
    result[4] += 0.015;
    result[5] += 0.0725;
  }
  if ( ( !(data[20].missing != -1) || (data[20].fvalue <= (float)81) ) ) {
    result[0] += 0.29237288135593226;
    result[1] += 0.13585805084745767;
    result[2] += 0.03442796610169492;
    result[3] += 0.10063559322033899;
    result[4] += 0.13797669491525427;
    result[5] += 0.29872881355932207;
  } else {
    result[0] += 0.00761904761904762;
    result[1] += 0.006666666666666668;
    result[2] += 0.8238095238095239;
    result[3] += 0.10761904761904763;
    result[4] += 0.004761904761904763;
    result[5] += 0.04952380952380953;
  }
  if ( ( !(data[4].missing != -1) || (data[4].fvalue <= (float)81) ) ) {
    result[0] += 0.30432475457681085;
    result[1] += 0.14141682143804724;
    result[2] += 0.03714513133457151;
    result[3] += 0.0888829928362961;
    result[4] += 0.14274343327142477;
    result[5] += 0.28548686654284955;
  } else {
    result[0] += 0.020813623462630087;
    result[1] += 0.006622516556291391;
    result[2] += 0.7871333964049196;
    result[3] += 0.11825922421948912;
    result[4] += 0.004730368968779565;
    result[5] += 0.06244087038789026;
  }
  if ( ( !(data[16].missing != -1) || (data[16].fvalue <= (float)81) ) ) {
    result[0] += 0.29591295116772826;
    result[1] += 0.15047770700636942;
    result[2] += 0.029723991507430998;
    result[3] += 0.09235668789808917;
    result[4] += 0.13561571125265393;
    result[5] += 0.29591295116772826;
  } else {
    result[0] += 0.012287334593572778;
    result[1] += 0;
    result[2] += 0.8412098298676749;
    result[3] += 0.12003780718336483;
    result[4] += 0;
    result[5] += 0.026465028355387523;
  }
  if ( ( !(data[31].missing != -1) || (data[31].fvalue <= (float)72.5) ) ) {
    result[0] += 0.029186935371785964;
    result[1] += 0.01389854065323141;
    result[2] += 0.018763029881862403;
    result[3] += 0.12647671994440585;
    result[4] += 0.1883252258512856;
    result[5] += 0.6233495482974287;
  } else {
    result[0] += 0.34750516681428995;
    result[1] += 0.1488042515500443;
    result[2] += 0.28816061411278415;
    result[3] += 0.08886920578683201;
    result[4] += 0.07263064658990256;
    result[5] += 0.054030115146147036;
  }
  if ( ( !(data[8].missing != -1) || (data[8].fvalue <= (float)79.5) ) ) {
    result[0] += 0.3158328752061572;
    result[1] += 0.13853765805387575;
    result[2] += 0.030236393622869707;
    result[3] += 0.09510720175920835;
    result[4] += 0.14018691588785046;
    result[5] += 0.2800989554700385;
  } else {
    result[0] += 0.015993265993265997;
    result[1] += 0.01346801346801347;
    result[2] += 0.7575757575757577;
    result[3] += 0.11952861952861954;
    result[4] += 0.005050505050505052;
    result[5] += 0.0883838383838384;
  }
  if ( ( !(data[20].missing != -1) || (data[20].fvalue <= (float)78.5) ) ) {
    result[0] += 0.32094313453536755;
    result[1] += 0.13841886269070736;
    result[2] += 0.012482662968099861;
    result[3] += 0.07461858529819695;
    result[4] += 0.14507628294036062;
    result[5] += 0.3084604715672677;
  } else {
    result[0] += 0.009009009009009009;
    result[1] += 0.009009009009009009;
    result[2] += 0.7428337428337428;
    result[3] += 0.13431613431613432;
    result[4] += 0.007371007371007371;
    result[5] += 0.09746109746109746;
  }
  if ( ( !(data[16].missing != -1) || (data[16].fvalue <= (float)78.5) ) ) {
    result[0] += 0.3327693175408911;
    result[1] += 0.14946418499717992;
    result[2] += 0.00874224478285392;
    result[3] += 0.06627185561195713;
    result[4] += 0.14326001128031585;
    result[5] += 0.29949238578680204;
  } else {
    result[0] += 0.02109375;
    result[1] += 0;
    result[2] += 0.7515625;
    result[3] += 0.1625;
    result[4] += 0.00390625;
    result[5] += 0.0609375;
  }
  if ( ( !(data[12].missing != -1) || (data[12].fvalue <= (float)81) ) ) {
    result[0] += 0.306079108043536;
    result[1] += 0.1468011680382267;
    result[2] += 0.02867002920095567;
    result[3] += 0.0905229625696841;
    result[4] += 0.1396336607379878;
    result[5] += 0.28829307140960975;
  } else {
    result[0] += 0.018885741265344664;
    result[1] += 0.0056657223796034;
    result[2] += 0.8045325779036827;
    result[3] += 0.125590179414542;
    result[4] += 0.003777148253068933;
    result[5] += 0.04154863078375826;
  }
  if ( ( !(data[20].missing != -1) || (data[20].fvalue <= (float)78.5) ) ) {
    result[0] += 0.3282913165266107;
    result[1] += 0.14397759103641458;
    result[2] += 0.019607843137254905;
    result[3] += 0.08039215686274512;
    result[4] += 0.14061624649859947;
    result[5] += 0.2871148459383754;
  } else {
    result[0] += 0.015127388535031847;
    result[1] += 0.007165605095541401;
    result[2] += 0.7428343949044586;
    result[3] += 0.14968152866242038;
    result[4] += 0.004777070063694267;
    result[5] += 0.0804140127388535;
  }
  if ( ( !(data[32].missing != -1) || (data[32].fvalue <= (float)78.5) ) ) {
    result[0] += 0.32768204558087827;
    result[1] += 0.1434130072262368;
    result[2] += 0.024735964424680377;
    result[3] += 0.07254030016675932;
    result[4] += 0.13952195664257921;
    result[5] += 0.29210672595886605;
  } else {
    result[0] += 0.007328990228013029;
    result[1] += 0.003257328990228013;
    result[2] += 0.7288273615635179;
    result[3] += 0.15716612377850162;
    result[4] += 0.02280130293159609;
    result[5] += 0.08061889250814332;
  }
  if ( ( !(data[4].missing != -1) || (data[4].fvalue <= (float)79.5) ) ) {
    result[0] += 0.3117352614015573;
    result[1] += 0.15517241379310345;
    result[2] += 0.02196885428253615;
    result[3] += 0.08731924360400445;
    result[4] += 0.12625139043381536;
    result[5] += 0.2975528364849833;
  } else {
    result[0] += 0.023577235772357725;
    result[1] += 0.00894308943089431;
    result[2] += 0.7560975609756098;
    result[3] += 0.13008130081300814;
    result[4] += 0.00894308943089431;
    result[5] += 0.07235772357723577;
  }
  if ( ( !(data[8].missing != -1) || (data[8].fvalue <= (float)81) ) ) {
    result[0] += 0.30911033930002674;
    result[1] += 0.14533796419983971;
    result[2] += 0.03152551429334758;
    result[3] += 0.10526315789473684;
    result[4] += 0.12530056104728826;
    result[5] += 0.2834624632647609;
  } else {
    result[0] += 0.012927054478301015;
    result[1] += 0.012003693444136657;
    result[2] += 0.7968605724838412;
    result[3] += 0.09141274238227147;
    result[4] += 0.0018467220683287165;
    result[5] += 0.08494921514312095;
  }
  if ( ( !(data[0].missing != -1) || (data[0].fvalue <= (float)78.5) ) ) {
    result[0] += 0.3138728323699422;
    result[1] += 0.14826589595375722;
    result[2] += 0.02138728323699422;
    result[3] += 0.0754335260115607;
    result[4] += 0.14104046242774568;
    result[5] += 0.3;
  } else {
    result[0] += 0.029282576866764276;
    result[1] += 0.012445095168374817;
    result[2] += 0.7064421669106882;
    result[3] += 0.1493411420204978;
    result[4] += 0.012445095168374817;
    result[5] += 0.09004392386530015;
  }
  if ( ( !(data[20].missing != -1) || (data[20].fvalue <= (float)81) ) ) {
    result[0] += 0.3111345090813372;
    result[1] += 0.13740458015267176;
    result[2] += 0.029744669649907872;
    result[3] += 0.08949723611476705;
    result[4] += 0.1426691234535404;
    result[5] += 0.2895498815477757;
  } else {
    result[0] += 0.008763388510223954;
    result[1] += 0.006815968841285297;
    result[2] += 0.8169425511197663;
    result[3] += 0.11879259980525804;
    result[4] += 0.0029211295034079843;
    result[5] += 0.045764362220058426;
  }
  if ( ( !(data[12].missing != -1) || (data[12].fvalue <= (float)81) ) ) {
    result[0] += 0.31238348868175764;
    result[1] += 0.13342210386151798;
    result[2] += 0.033288948069241014;
    result[3] += 0.08495339547270306;
    result[4] += 0.13022636484687083;
    result[5] += 0.3057256990679095;
  } else {
    result[0] += 0.014005602240896359;
    result[1] += 0.008403361344537815;
    result[2] += 0.8160597572362278;
    result[3] += 0.1092436974789916;
    result[4] += 0.0009337068160597573;
    result[5] += 0.051353874883286646;
  }
  if ( ( !(data[7].missing != -1) || (data[7].fvalue <= (float)73.5) ) ) {
    result[0] += 0.025607353906762966;
    result[1] += 0.020354563361785948;
    result[2] += 0.013788575180564675;
    result[3] += 0.139198949441891;
    result[4] += 0.20157583716349312;
    result[5] += 0.5994747209455022;
  } else {
    result[0] += 0.33575537390251287;
    result[1] += 0.14925825007568877;
    result[2] += 0.2970027247956403;
    result[3] += 0.0877989706327581;
    result[4] += 0.06327580986981532;
    result[5] += 0.06690887072358462;
  }
  
  // Average tree outputs
  result[0] /= 20;
  result[1] /= 20;
  result[2] /= 20;
  result[3] /= 20;
  result[4] /= 20;
  result[5] /= 20;
  
  // Apply base_scores
  result[0] += 0;
  result[1] += 0;
  result[2] += 0;
  result[3] += 0;
  result[4] += 0;
  result[5] += 0;
  
  // Apply postprocessor
  if (!pred_margin) { postprocess(result); }
}

void postprocess(float* result) {
  // Do nothing
}


int main() {
    float result[MAX_N_CLASS];
    union Entry input[TEST_DATA_COLS];
    char line[1024];
    

    FILE* file = fopen("./codegen/dataset_146/split_3/test_data.csv", "r");
    if (file == NULL) {
        printf("Error opening file\n");
        return 1;
    }

    while (fgets(line, sizeof(line), file)) {
        char *ptr = line;
        for (int i = 0; i < TEST_DATA_COLS; i++) {
            sscanf(ptr, "%f", &(input[i].fvalue));
            input[i].missing = -1;
            while (*ptr != ',' && *ptr != '\n' && *ptr != '\0') ptr++;  // Skip to next comma
            if (*ptr == ',') ptr++;  // Move past the comma
        }
        predict(input, 0, result);
        
    }
    

    return 0;
}
