
#include "header.h"


static const int32_t num_class[] = {  6, };

int32_t get_num_target(void) {
  return N_TARGET;
}
void get_num_class(int32_t* out) {
  for (int i = 0; i < N_TARGET; ++i) {
    out[i] = num_class[i];
  }
}
int32_t get_num_feature(void) {
  return 36;
}
const char* get_threshold_type(void) {
  return "float32";
}
const char* get_leaf_output_type(void) {
  return "float32";
}


void predict(union Entry* data, int pred_margin, float* result) {
  unsigned int tmp;
  if ( ( !(data[4].missing != -1) || ((*( ((int*)(data)) + 4 ))<=((int)(0x429f0000))) ) ) {
    result[0] += 0.3072272602363287;
    result[1] += 0.16185765320142897;
    result[2] += 0.028304479252541908;
    result[3] += 0.0838142346798571;
    result[4] += 0.13575158010442429;
    result[5] += 0.2830447925254191;
  } else {
    result[0] += 0.02780117944397641;
    result[1] += 0.005897219882055603;
    result[2] += 0.7759056444818871;
    result[3] += 0.10699241786015164;
    result[4] += 0.007582139848357203;
    result[5] += 0.07582139848357203;
  }
  if ( ( !(data[32].missing != -1) || ((*( ((int*)(data)) + 32 ))<=((int)(0x429f0000))) ) ) {
    result[0] += 0.3166532149582997;
    result[1] += 0.14043583535108958;
    result[2] += 0.02824858757062147;
    result[3] += 0.09200968523002422;
    result[4] += 0.14474038202851763;
    result[5] += 0.2779122948614474;
  } else {
    result[0] += 0.011722272317403066;
    result[1] += 0.0009017132551848512;
    result[2] += 0.7908025247971145;
    result[3] += 0.10279531109107304;
    result[4] += 0.018935978358881875;
    result[5] += 0.07484220018034266;
  }
  if ( ( !(data[16].missing != -1) || ((*( ((int*)(data)) + 16 ))<=((int)(0x429f0000))) ) ) {
    result[0] += 0.32365826944140197;
    result[1] += 0.1508762322015334;
    result[2] += 0.011774370208105149;
    result[3] += 0.09008762322015335;
    result[4] += 0.1303395399780942;
    result[5] += 0.29326396495071194;
  } else {
    result[0] += 0.014480408858603069;
    result[1] += 0;
    result[2] += 0.8074957410562181;
    result[3] += 0.1345826235093697;
    result[4] += 0.0008517887563884158;
    result[5] += 0.04258943781942079;
  }
  if ( ( !(data[28].missing != -1) || ((*( ((int*)(data)) + 28 ))<=((int)(0x42a20000))) ) ) {
    result[0] += 0.30183657173276557;
    result[1] += 0.14080383284535536;
    result[2] += 0.03273888741016769;
    result[3] += 0.08650519031141869;
    result[4] += 0.1461272291722119;
    result[5] += 0.29198828852808095;
  } else {
    result[0] += 0.011225444340505144;
    result[1] += 0.006548175865294668;
    result[2] += 0.8241347053320861;
    result[3] += 0.10944808231992516;
    result[4] += 0.004677268475210477;
    result[5] += 0.04396632366697849;
  }
  if ( ( !(data[28].missing != -1) || ((*( ((int*)(data)) + 28 ))<=((int)(0x42a20000))) ) ) {
    result[0] += 0.31888297872340426;
    result[1] += 0.14122340425531915;
    result[2] += 0.03563829787234043;
    result[3] += 0.09441489361702128;
    result[4] += 0.13085106382978723;
    result[5] += 0.2789893617021277;
  } else {
    result[0] += 0.012195121951219514;
    result[1] += 0.005628517823639776;
    result[2] += 0.826454033771107;
    result[3] += 0.10131332082551596;
    result[4] += 0.006566604127579739;
    result[5] += 0.047842401500938096;
  }
  if ( ( !(data[28].missing != -1) || ((*( ((int*)(data)) + 28 ))<=((int)(0x42a20000))) ) ) {
    result[0] += 0.3149480415667466;
    result[1] += 0.13935518252065016;
    result[2] += 0.03543831601385558;
    result[3] += 0.10045297095656808;
    result[4] += 0.1377564614974687;
    result[5] += 0.2720490274447109;
  } else {
    result[0] += 0.012115563839701771;
    result[1] += 0.005591798695246971;
    result[2] += 0.8285181733457595;
    result[3] += 0.10344827586206896;
    result[4] += 0.0065237651444548;
    result[5] += 0.04380242311276794;
  }
  if ( ( !(data[28].missing != -1) || ((*( ((int*)(data)) + 28 ))<=((int)(0x42a20000))) ) ) {
    result[0] += 0.2936822627544277;
    result[1] += 0.1401004493787999;
    result[2] += 0.036214644462067146;
    result[3] += 0.08723235527359238;
    result[4] += 0.1430081945545863;
    result[5] += 0.29976209357652656;
  } else {
    result[0] += 0.005752636625119847;
    result[1] += 0.005752636625119847;
    result[2] += 0.8197507190795782;
    result[3] += 0.11217641418983701;
    result[4] += 0.006711409395973154;
    result[5] += 0.04985618408437201;
  }
  if ( ( !(data[24].missing != -1) || ((*( ((int*)(data)) + 24 ))<=((int)(0x429f0000))) ) ) {
    result[0] += 0.33533424283765345;
    result[1] += 0.1377899045020464;
    result[2] += 0.028922237380627557;
    result[3] += 0.08894952251023193;
    result[4] += 0.13096862210095497;
    result[5] += 0.27803547066848566;
  } else {
    result[0] += 0.02153316106804479;
    result[1] += 0.009474590869939707;
    result[2] += 0.7769164513350559;
    result[3] += 0.10938845822566753;
    result[4] += 0.014642549526270457;
    result[5] += 0.06804478897502153;
  }
  if ( ( !(data[12].missing != -1) || ((*( ((int*)(data)) + 12 ))<=((int)(0x429f0000))) ) ) {
    result[0] += 0.3003865267807841;
    result[1] += 0.15461071231363888;
    result[2] += 0.022087244616234125;
    result[3] += 0.08337934842628382;
    result[4] += 0.1548868028713418;
    result[5] += 0.2846493649917173;
  } else {
    result[0] += 0.024916943521594678;
    result[1] += 0.009136212624584717;
    result[2] += 0.7707641196013287;
    result[3] += 0.13621262458471758;
    result[4] += 0.006644518272425248;
    result[5] += 0.052325581395348826;
  }
  if ( ( !(data[28].missing != -1) || ((*( ((int*)(data)) + 28 ))<=((int)(0x42a20000))) ) ) {
    result[0] += 0.2986461375099549;
    result[1] += 0.14520838863817362;
    result[2] += 0.03636846296787895;
    result[3] += 0.1008760286700292;
    result[4] += 0.1422882930714096;
    result[5] += 0.27661268914255377;
  } else {
    result[0] += 0.0037771482530689323;
    result[1] += 0.004721435316336165;
    result[2] += 0.834749763928234;
    result[3] += 0.10198300283286116;
    result[4] += 0.0028328611898016994;
    result[5] += 0.05193578847969781;
  }
  if ( ( !(data[16].missing != -1) || ((*( ((int*)(data)) + 16 ))<=((int)(0x429f0000))) ) ) {
    result[0] += 0.30818844643858667;
    result[1] += 0.1522714526079641;
    result[2] += 0.015703869882220976;
    result[3] += 0.09057767807066741;
    result[4] += 0.14441951766685363;
    result[5] += 0.28883903533370725;
  } else {
    result[0] += 0.01746031746031746;
    result[1] += 0;
    result[2] += 0.8103174603174603;
    result[3] += 0.12380952380952381;
    result[4] += 0.004761904761904762;
    result[5] += 0.04365079365079365;
  }
  if ( ( !(data[16].missing != -1) || ((*( ((int*)(data)) + 16 ))<=((int)(0x429d0000))) ) ) {
    result[0] += 0.3247742663656885;
    result[1] += 0.1577313769751693;
    result[2] += 0.006489841986455982;
    result[3] += 0.07505643340857787;
    result[4] += 0.14700902934537247;
    result[5] += 0.28893905191873587;
  } else {
    result[0] += 0.01794071762870515;
    result[1] += 0.00078003120124805;
    result[2] += 0.7886115444617785;
    result[3] += 0.12792511700468018;
    result[4] += 0.00546021840873635;
    result[5] += 0.059282371294851796;
  }
  if ( ( !(data[0].missing != -1) || ((*( ((int*)(data)) + 0 ))<=((int)(0x429f0000))) ) ) {
    result[0] += 0.3196973942280751;
    result[1] += 0.14962174278509385;
    result[2] += 0.023816195012608572;
    result[3] += 0.08069487251330905;
    result[4] += 0.13224992995236762;
    result[5] += 0.2939198655085458;
  } else {
    result[0] += 0.03977724741447892;
    result[1] += 0.003977724741447892;
    result[2] += 0.7517899761336515;
    result[3] += 0.11137629276054097;
    result[4] += 0.015910898965791568;
    result[5] += 0.07716785998408911;
  }
  if ( ( !(data[28].missing != -1) || ((*( ((int*)(data)) + 28 ))<=((int)(0x42a20000))) ) ) {
    result[0] += 0.29538216560509556;
    result[1] += 0.14304670912951167;
    result[2] += 0.037420382165605094;
    result[3] += 0.09447983014861996;
    result[4] += 0.14145435244161358;
    result[5] += 0.28821656050955413;
  } else {
    result[0] += 0.004725897920604915;
    result[1] += 0.005671077504725898;
    result[2] += 0.8289224952741021;
    result[3] += 0.10775047258979206;
    result[4] += 0.005671077504725898;
    result[5] += 0.04725897920604915;
  }
  if ( ( !(data[16].missing != -1) || ((*( ((int*)(data)) + 16 ))<=((int)(0x429f0000))) ) ) {
    result[0] += 0.3125512715340443;
    result[1] += 0.1501230516817063;
    result[2] += 0.012031719989062073;
    result[3] += 0.07465135356849877;
    result[4] += 0.1473885698660104;
    result[5] += 0.30325403336067813;
  } else {
    result[0] += 0.018819503849443968;
    result[1] += 0;
    result[2] += 0.7887082976903336;
    result[3] += 0.14029084687767324;
    result[4] += 0.000855431993156544;
    result[5] += 0.05132591958939264;
  }
  
  // Average tree outputs
  result[0] /= 15;
  result[1] /= 15;
  result[2] /= 15;
  result[3] /= 15;
  result[4] /= 15;
  result[5] /= 15;
  
  // Apply base_scores
  result[0] += 0;
  result[1] += 0;
  result[2] += 0;
  result[3] += 0;
  result[4] += 0;
  result[5] += 0;
  
  // Apply postprocessor
  if (!pred_margin) { postprocess(result); }
}

void postprocess(float* result) {
  // Do nothing
}


int main() {
    float result[MAX_N_CLASS];
    union Entry input[TEST_DATA_COLS];
    char line[1024];
    

    FILE* file = fopen("./codegen/dataset_146/split_4/test_data.csv", "r");
    if (file == NULL) {
        printf("Error opening file\n");
        return 1;
    }

    while (fgets(line, sizeof(line), file)) {
        char *ptr = line;
        for (int i = 0; i < TEST_DATA_COLS; i++) {
            sscanf(ptr, "%f", &(input[i].fvalue));
            input[i].missing = -1;
            while (*ptr != ',' && *ptr != '\n' && *ptr != '\0') ptr++;  // Skip to next comma
            if (*ptr == ',') ptr++;  // Move past the comma
        }
        predict(input, 0, result);
        
    }
    

    return 0;
}
