
#include "header.h"


static const int32_t num_class[] = {  6, };

int32_t get_num_target(void) {
  return N_TARGET;
}
void get_num_class(int32_t* out) {
  for (int i = 0; i < N_TARGET; ++i) {
    out[i] = num_class[i];
  }
}
int32_t get_num_feature(void) {
  return 36;
}
const char* get_threshold_type(void) {
  return "float32";
}
const char* get_leaf_output_type(void) {
  return "float32";
}


void predict(union Entry* data, int pred_margin, float* result) {
  unsigned int tmp;
  if ( ( !(data[28].missing != -1) || (data[28].fvalue <= (float)79.5) ) ) {
    result[0] += 0.3104860731840524;
    result[1] += 0.12725286728563626;
    result[2] += 0.02785363189513927;
    result[3] += 0.0922992900054615;
    result[4] += 0.14773347897323866;
    result[5] += 0.2943746586564719;
  } else {
    result[0] += 0.01288659793814433;
    result[1] += 0.002577319587628866;
    result[2] += 0.7860824742268041;
    result[3] += 0.1254295532646048;
    result[4] += 0.02147766323024055;
    result[5] += 0.05154639175257732;
  }
  if ( ( !(data[20].missing != -1) || (data[20].fvalue <= (float)79.5) ) ) {
    result[0] += 0.3204434829637642;
    result[1] += 0.14305029745808545;
    result[2] += 0.023526230394808004;
    result[3] += 0.08707409410492158;
    result[4] += 0.14196863169280693;
    result[5] += 0.28393726338561387;
  } else {
    result[0] += 0.008865248226950355;
    result[1] += 0.0035460992907801418;
    result[2] += 0.8085106382978723;
    result[3] += 0.11524822695035461;
    result[4] += 0.005319148936170213;
    result[5] += 0.05851063829787234;
  }
  if ( ( !(data[12].missing != -1) || (data[12].fvalue <= (float)81) ) ) {
    result[0] += 0.3117024165082813;
    result[1] += 0.13901710562041814;
    result[2] += 0.025522671734998642;
    result[3] += 0.09204452891664404;
    result[4] += 0.15177844148791747;
    result[5] += 0.27993483573174044;
  } else {
    result[0] += 0.01837270341207349;
    result[1] += 0.0026246719160104987;
    result[2] += 0.8013998250218722;
    result[3] += 0.13123359580052493;
    result[4] += 0.003499562554680665;
    result[5] += 0.04286964129483815;
  }
  if ( ( !(data[20].missing != -1) || (data[20].fvalue <= (float)79.5) ) ) {
    result[0] += 0.3048548955790616;
    result[1] += 0.14212096555465148;
    result[2] += 0.027393544887442365;
    result[3] += 0.09438567941415785;
    result[4] += 0.1304583672362354;
    result[5] += 0.30078654732845134;
  } else {
    result[0] += 0.013169446883230906;
    result[1] += 0.01229148375768218;
    result[2] += 0.7717295873573311;
    result[3] += 0.12642669007901672;
    result[4] += 0.009657594381035998;
    result[5] += 0.06672519754170327;
  }
  if ( ( !(data[20].missing != -1) || (data[20].fvalue <= (float)81) ) ) {
    result[0] += 0.2982969664715274;
    result[1] += 0.13491218733368812;
    result[2] += 0.03725385843533795;
    result[3] += 0.10298030867482703;
    result[4] += 0.13677488025545503;
    result[5] += 0.28978179882916444;
  } else {
    result[0] += 0.010299625468164793;
    result[1] += 0.00749063670411985;
    result[2] += 0.8380149812734082;
    result[3] += 0.10112359550561797;
    result[4] += 0.003745318352059925;
    result[5] += 0.03932584269662921;
  }
  if ( ( !(data[0].missing != -1) || (data[0].fvalue <= (float)81) ) ) {
    result[0] += 0.307179076594609;
    result[1] += 0.13957832933013078;
    result[2] += 0.03095809981318388;
    result[3] += 0.09527622097678143;
    result[4] += 0.14758473445423004;
    result[5] += 0.27942353883106485;
  } else {
    result[0] += 0.03151065801668211;
    result[1] += 0.008341056533827619;
    result[2] += 0.76274328081557;
    result[3] += 0.11862835959221502;
    result[4] += 0.006487488415199258;
    result[5] += 0.07228915662650602;
  }
  if ( ( !(data[28].missing != -1) || (data[28].fvalue <= (float)81) ) ) {
    result[0] += 0.3054611967598641;
    result[1] += 0.14058008884243534;
    result[2] += 0.03135615364515286;
    result[3] += 0.09903318526260779;
    result[4] += 0.14841912725372355;
    result[5] += 0.27515024823621637;
  } else {
    result[0] += 0.003003003003003002;
    result[1] += 0.005005005005005004;
    result[2] += 0.7967967967967966;
    result[3] += 0.1271271271271271;
    result[4] += 0.01301301301301301;
    result[5] += 0.05505505505505504;
  }
  if ( ( !(data[0].missing != -1) || (data[0].fvalue <= (float)79.5) ) ) {
    result[0] += 0.30394626364399663;
    result[1] += 0.1472152253008676;
    result[2] += 0.028267562272600057;
    result[3] += 0.08564231738035265;
    result[4] += 0.1446963336132102;
    result[5] += 0.29023229778897286;
  } else {
    result[0] += 0.047086991221069435;
    result[1] += 0.0031923383878691143;
    result[2] += 0.7174780526735834;
    result[3] += 0.14285714285714285;
    result[4] += 0.015163607342378291;
    result[5] += 0.0742218675179569;
  }
  if ( ( !(data[4].missing != -1) || (data[4].fvalue <= (float)81) ) ) {
    result[0] += 0.31574718800214246;
    result[1] += 0.13444027852169255;
    result[2] += 0.03936797000535619;
    result[3] += 0.08971612212104982;
    result[4] += 0.14006427423674345;
    result[5] += 0.2806641671130155;
  } else {
    result[0] += 0.019230769230769232;
    result[1] += 0.005494505494505495;
    result[2] += 0.7893772893772893;
    result[3] += 0.11172161172161173;
    result[4] += 0.011904761904761904;
    result[5] += 0.06227106227106227;
  }
  if ( ( !(data[0].missing != -1) || (data[0].fvalue <= (float)78.5) ) ) {
    result[0] += 0.3159840728100114;
    result[1] += 0.13936291240045506;
    result[2] += 0.017918088737201365;
    result[3] += 0.07764505119453925;
    result[4] += 0.15955631399317405;
    result[5] += 0.2895335608646189;
  } else {
    result[0] += 0.044274809160305344;
    result[1] += 0.006870229007633588;
    result[2] += 0.7091603053435115;
    result[3] += 0.14580152671755725;
    result[4] += 0.012977099236641221;
    result[5] += 0.08091603053435115;
  }
  if ( ( !(data[28].missing != -1) || (data[28].fvalue <= (float)79.5) ) ) {
    result[0] += 0.3233680746023039;
    result[1] += 0.14097641250685683;
    result[2] += 0.027427317608337904;
    result[3] += 0.0902358749314317;
    result[4] += 0.14701042238069117;
    result[5] += 0.27098189797037847;
  } else {
    result[0] += 0.015254237288135594;
    result[1] += 0.003389830508474576;
    result[2] += 0.7788135593220339;
    result[3] += 0.13220338983050847;
    result[4] += 0.019491525423728815;
    result[5] += 0.05084745762711865;
  }
  if ( ( !(data[23].missing != -1) || (data[23].fvalue <= (float)72.5) ) ) {
    result[0] += 0.0145791915175613;
    result[1] += 0.015241882041086813;
    result[2] += 0.010603048376408217;
    result[3] += 0.12524850894632206;
    result[4] += 0.20742213386348576;
    result[5] += 0.6269052352551359;
  } else {
    result[0] += 0.3382574615616521;
    result[1] += 0.15797407295749172;
    result[2] += 0.28881519445281884;
    result[3] += 0.0826047633403678;
    result[4] += 0.07145010551703346;
    result[5] += 0.060898402170636114;
  }
  if ( ( !(data[16].missing != -1) || (data[16].fvalue <= (float)79.5) ) ) {
    result[0] += 0.3072074540970129;
    result[1] += 0.14387503425596054;
    result[2] += 0.015072622636338722;
    result[3] += 0.0915319265552206;
    result[4] += 0.1485338448890107;
    result[5] += 0.2937791175664566;
  } else {
    result[0] += 0.016142735768903994;
    result[1] += 0;
    result[2] += 0.7757009345794392;
    result[3] += 0.1588785046728972;
    result[4] += 0.0016992353440951572;
    result[5] += 0.0475785896346644;
  }
  if ( ( !(data[16].missing != -1) || (data[16].fvalue <= (float)79.5) ) ) {
    result[0] += 0.3156884256719693;
    result[1] += 0.14289632473944047;
    result[2] += 0.015085024684585847;
    result[3] += 0.0902358749314317;
    result[4] += 0.1508502468458585;
    result[5] += 0.2852441031267142;
  } else {
    result[0] += 0.009322033898305085;
    result[1] += 0;
    result[2] += 0.8084745762711865;
    result[3] += 0.13983050847457626;
    result[4] += 0.001694915254237288;
    result[5] += 0.04067796610169491;
  }
  if ( ( !(data[24].missing != -1) || (data[24].fvalue <= (float)81) ) ) {
    result[0] += 0.31035393555203383;
    result[1] += 0.1405176967776017;
    result[2] += 0.029846804014791336;
    result[3] += 0.101162176439514;
    result[4] += 0.14078182778658213;
    result[5] += 0.277337559429477;
  } else {
    result[0] += 0.008653846153846153;
    result[1] += 0.007692307692307691;
    result[2] += 0.808653846153846;
    result[3] += 0.11730769230769228;
    result[4] += 0.015384615384615382;
    result[5] += 0.0423076923076923;
  }
  if ( ( !(data[28].missing != -1) || (data[28].fvalue <= (float)78.5) ) ) {
    result[0] += 0.3380202474690664;
    result[1] += 0.13638920134983126;
    result[2] += 0.016591676040494937;
    result[3] += 0.08183352080989877;
    result[4] += 0.14791901012373454;
    result[5] += 0.27924634420697414;
  } else {
    result[0] += 0.023622047244094488;
    result[1] += 0.003937007874015748;
    result[2] += 0.74251968503937;
    result[3] += 0.14330708661417324;
    result[4] += 0.01811023622047244;
    result[5] += 0.06850393700787402;
  }
  if ( ( !(data[15].missing != -1) || (data[15].fvalue <= (float)73.5) ) ) {
    result[0] += 0.03415559772296015;
    result[1] += 0.012017710309930424;
    result[2] += 0.001265022137887413;
    result[3] += 0.13219481340923467;
    result[4] += 0.19924098671726756;
    result[5] += 0.6211258697027198;
  } else {
    result[0] += 0.3346687211093991;
    result[1] += 0.15007704160246532;
    result[2] += 0.3115562403697997;
    result[3] += 0.08597842835130971;
    result[4] += 0.0650231124807396;
    result[5] += 0.05269645608628659;
  }
  if ( ( !(data[4].missing != -1) || (data[4].fvalue <= (float)78.5) ) ) {
    result[0] += 0.3342752189884148;
    result[1] += 0.14043515117264765;
    result[2] += 0.0175190731845154;
    result[3] += 0.08109635490251484;
    result[4] += 0.138739756993501;
    result[5] += 0.28793444475840635;
  } else {
    result[0] += 0.028749028749028748;
    result[1] += 0.01320901320901321;
    result[2] += 0.7272727272727273;
    result[3] += 0.14840714840714841;
    result[4] += 0.005439005439005439;
    result[5] += 0.07692307692307693;
  }
  if ( ( !(data[4].missing != -1) || (data[4].fvalue <= (float)81) ) ) {
    result[0] += 0.30420969023034156;
    result[1] += 0.13343923749007147;
    result[2] += 0.04183214191157003;
    result[3] += 0.0976965845909452;
    result[4] += 0.16256288059306329;
    result[5] += 0.2602594651840085;
  } else {
    result[0] += 0.03145853193517636;
    result[1] += 0.012392755004766444;
    result[2] += 0.7998093422306959;
    result[3] += 0.10581506196377502;
    result[4] += 0.004766444232602479;
    result[5] += 0.04575786463298379;
  }
  if ( ( !(data[8].missing != -1) || (data[8].fvalue <= (float)79.5) ) ) {
    result[0] += 0.3182188433342384;
    result[1] += 0.13277219657887593;
    result[2] += 0.0325821341297855;
    result[3] += 0.08960086885691013;
    result[4] += 0.1525929948411621;
    result[5] += 0.274232962259028;
  } else {
    result[0] += 0.020997375328083993;
    result[1] += 0.015748031496062995;
    result[2] += 0.7594050743657044;
    result[3] += 0.11723534558180229;
    result[4] += 0.007874015748031498;
    result[5] += 0.07874015748031497;
  }
  
  // Average tree outputs
  result[0] /= 20;
  result[1] /= 20;
  result[2] /= 20;
  result[3] /= 20;
  result[4] /= 20;
  result[5] /= 20;
  
  // Apply base_scores
  result[0] += 0;
  result[1] += 0;
  result[2] += 0;
  result[3] += 0;
  result[4] += 0;
  result[5] += 0;
  
  // Apply postprocessor
  if (!pred_margin) { postprocess(result); }
}

void postprocess(float* result) {
  // Do nothing
}


int main() {
    float result[MAX_N_CLASS];
    union Entry input[TEST_DATA_COLS];
    char line[1024];
    

    FILE* file = fopen("./codegen/dataset_146/split_0/test_data.csv", "r");
    if (file == NULL) {
        printf("Error opening file\n");
        return 1;
    }

    while (fgets(line, sizeof(line), file)) {
        char *ptr = line;
        for (int i = 0; i < TEST_DATA_COLS; i++) {
            sscanf(ptr, "%f", &(input[i].fvalue));
            input[i].missing = -1;
            while (*ptr != ',' && *ptr != '\n' && *ptr != '\0') ptr++;  // Skip to next comma
            if (*ptr == ',') ptr++;  // Move past the comma
        }
        predict(input, 0, result);
        
    }
    

    return 0;
}
